Before I post the tests and a further explanation of the code I listed in <a href="/blog/2009/02/challenge-do-you-truly-understand-this-code">the readable code challenge</a>, I wanted to post only the commented version of this code:

<script src="https://gist.github.com/3684309.js?file=s1.cs"></script>

I hope the comments clarify the problem sufficiently. If not, tell me what's not clear to you because it might mean I need to clarify the comments more.  Also, suggestions on how to make this code more readable and reducing the need for comments would be very welcome :)

I'll post the tests tomorrow, and then you can all decide what you think is more communicative: the comments, or the tests.