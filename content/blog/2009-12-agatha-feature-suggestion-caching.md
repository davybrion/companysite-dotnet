<p>Someone recently asked me if it would be possible to cache responses with an Agatha service layer and just send back the cached responses when matching requests are sent to the service layer.&#160; I’ve been thinking about this a bit lately, and i think it would be a tremendous feature.&#160; In this post, i just want to list a couple of ideas on how it could work and what we’d need to take into account to make it work.&#160; Please feel free to leave your suggestions/thoughts on this since i can definitely use all of the feedback i can get to implement a feature like this.</p>  <p>The idea is basically to implement a caching layer which works very similar to NHibernate’s Second Level Cache.&#160; You would need to be able to define which request/response combination is eligible for caching.&#160; When a request/response combination is eligible for caching, Agatha should check to see if a cached response is already available for a particular incoming request.&#160; That would mean that the request type would need to override the Equals method to compare the values.&#160;&#160; If a previous request has already been processed which is equal to the current request, the corresponding cached response could be sent back immediately without having to handle it again.&#160; Obviously, this check would only happen for requests which have been made eligible for caching.</p>  <p>We’d also need to provide a way to invalidate the cache.&#160; Both time-based expiration and explicit removal from the cache should be possible.&#160; For time-based expiration we could just provide some sort of time-out setting in the same place where you enable the caching for the request.&#160; I’d probably do that through a .NET attribute which you can put on your Request type, and the time-out would simply be a property of the attribute.&#160; For explicit removal, i’d probably go with a ‘region’-approach, similar to the regions in NHibernate’s Second Level Cache.&#160; For instance, when declaring a request to be eligible for caching, one of the properties of the caching attribute could be a region name, and then we’d need to give you the ability to clear a certain region of the cache in your request handlers when it’s necessary to do so.</p>  <p>That’s pretty much all i can think of for now.&#160; It’s not much yet, but i do think it could really be a tremendous improvement to Agatha.&#160; The performance benefits for requests that deal with mostly static data, or data that doesn’t change frequently could be huge.&#160; And the required coding effort for developers using Agatha would be minimal… simply put the correct attribute on your request type and explicit clearing of the right cache region when necessary would be all there is to it.</p>  <p>Thoughts?</p>